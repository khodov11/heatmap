<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Mapa Ryzyka – Olsztyn</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>
    <style>
        html, body, #map { height: 100%; margin: 0; padding: 0; }
    </style>
</head>
<body>
<div id="map"></div>
<script>
    // Współrzędne + wagi
    var heatPoints = [
        [53.786265, 20.531068, 1],
        [53.779362, 20.469259, 1],
        [53.784298, 20.477431, 1],
        [53.783877, 20.486506, 1],
        [53.791964, 20.481459, 1],
        [53.798846, 20.485916, 1],
        [53.806605, 20.402269, 1],
        [53.741659, 20.500890, 1],
        [53.796968, 20.499791, 1],
        [53.80113, 20.39603, 1],
        [53.797785, 20.546787, 1],
        [53.789654, 20.507243, 1],
        [53.79821, 20.48208, 1],
        [53.782076, 20.484672, 1],
        [53.781789, 20.488212, 1],
        [53.779215, 20.486516, 1],
        [53.789556, 20.494522, 1],
        [53.797345, 20.523198, 1],
        [53.777290, 20.466242, 1],
        [53.774877, 20.467769, 1],
        [53.790908, 20.500133, 1],
        [53.741667, 20.500815, 1],
        [53.797345, 20.523198, 1],
        [53.808182, 20.395044, 1],
        [53.808079, 20.395362, 1],
        [53.779416, 20.501246, 1],
        [53.789556, 20.494522, 1],
        [53.785537, 20.484562, 1],
        [53.803854, 20.481416, 1],
        [53.786075, 20.532709, 1],
        [53.779847, 20.488102, 1],
        [53.787154, 20.523849, 1],
        [53.740800, 20.514528, 1],
        [53.782203, 20.493574, 1],
        [53.790116, 20.486660, 1],
        [53.772374, 20.488561, 1],
        [53.770132, 20.504197, 1],
        [53.774987, 20.492758, 1]
    ];

    // Podkład 1: Grayscale
    var grayscale = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
        attribution: '&copy; CartoDB',
        subdomains: 'abcd',
        maxZoom: 20
    });

    // Podkład 2: OpenStreetMap Roads
    var roads = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors',
        maxZoom: 20
    });

    // Heatmapa
    var heat = L.heatLayer(heatPoints, {
        radius: 40,
        blur: 30,
        minOpacity: 0.4,
        maxOpacity: 0.8,
        gradient: {
            0.2: 'yellow',
            0.5: 'orange',
            0.8: 'red'
        }
    });

    // Markery
    var markerGroup = L.layerGroup();
    heatPoints.forEach(function(pt) {
        var marker = L.circleMarker([pt[0], pt[1]], {
            radius: 5,
            fillColor: "#f03",
            color: "#000",
            weight: 1,
            opacity: 1,
            fillOpacity: 0.8
        }).bindPopup("Lat: " + pt[0].toFixed(5) + "<br>Lon: " + pt[1].toFixed(5));
        markerGroup.addLayer(marker);
    });

    // Inicjalizacja mapy
    var map = L.map('map', {
        center: [53.78, 20.49],
        zoom: 12,
        layers: [grayscale, heat, markerGroup]
    });

    // Przełącznik warstw
    var baseLayers = {
        "Mapa jasna (Grayscale)": grayscale,
        "Mapa dróg (OSM)": roads
    };

    var overlays = {
        "Heatmapa": heat,
        "Markery": markerGroup
    };

    L.control.layers(baseLayers, overlays, {collapsed: false}).addTo(map);

    // Skala
    L.control.scale().addTo(map);

</script>
</body>
</html>
